{% extends "Stocks/layouts/base.html" %}
{% block container %}
    <div id="main" data-name="reviews">
        <div class="con-head">
            <h1>{{ title }}</h1>
            <form action="/admin/max_stock/index/">
                <div class="text-box">
                    <label>
                        <span>Search:</span>
                        <input type="text" name="keywords">
                    </label>
                </div>
                <div class="text-box">
                    <label>
                        <span>Warehouse:</span>
                        <select name="warehouse" id="">
                            <option value="">All</option>
                            <option value="EXL">EXL</option>
                            <option value="TWU">TWU</option>
                            <option value="Hanover">Hanover</option>
                            <option value="ILL">ILL</option>
                            <option value="WA">WA</option>
                            <option value="EGO">EGO</option>
                        </select>
                    </label>
                </div>
                <div class="text-box-btn">
                    <label>
                        <input type="submit" value="Search">
                    </label>
                </div>
            </form>
            <div class="con-head-right">
                <div class="btn btn-green">
                    <button id="btn_export_stocks">Export</button>
                </div>
                <div class="btn btn-blue">
                    <button id="import_index">Import</button>
                </div>
            </div>
            <div class="clear"></div>
        </div>
        <div class="con-body">
            <table id="datas" class="tb-datas">
                <tr id="tr-head">
                    <th>Sku</th>
                    <th>Warehouse</th>
                    <th>Qty</th>
                    <th>Date</th>
                </tr>
                {% for val in stock_list %}
                <tr class="tr-stock-blue{{ val.is_same }}">
                    <td>{{ val.sku }}</td>
                    <td>{{ val.warehouse }}</td>
                    <td>{{ val.qty }}</td>
                    <td>{{ val.created }}</td>
                </tr>
                {% endfor %}

            </table>
        </div>
    </div>
    <div class="hide" id="import_modal">
        <form id="import_form" action="/admin/max_stock/stock_checked/" method="post" enctype="multipart/form-data">
            <input type="file" name="myfile">
            <input type="submit" value="Submit" id="btn_import_modal">
        </form>
        <div id="import_msg"></div>
    </div>
    <script>
        $(document).ready(function(){
          $('input[name="keywords"]').val("{{ keywords }}");
          $('select[name="warehouse"]').val('{{ warehouse }}');
          $("form[name='userLogin']").submit(function(e){
            e.preventDefault();
          });
          $('#import_index').on('click',function () {
                $('.wrap-paper').removeClass('hide');
                $('#import_modal').removeClass('hide');
            });
            $('body').on('click','.wrap-paper' , function(){
                $('.wrap-paper').addClass('hide');
                $('#import_modal').addClass('hide');
            });
        });
        $('#btn_login').on('click',function () {
            var data = {
              'username':$('input[name="username"]').val(),
              'password':$('input[name="password"]').val()
            };
            $.post('/admin/maxlead_site/login/',data,function (re) {
               if(re.code==0){
                   alert(re.msg);
               }
               if(re.code==99){
                   window.location.href='/admin/max_stock/index/';
               }
            },'json');
            return false;
        });

        $('#btn_export_stocks').on('click',function () {
            var keywords = $('input[name="keywords"]').val();
            var warehouse = $('select[name="warehouse"]').val();
            var url = '/admin/max_stock/export_stocks/?keywords='+keywords+'&warehouse='+warehouse;
            window.location.href=url;
        });
    </script>
{% endblock %}